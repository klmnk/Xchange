<!DOCTYPE html>

<html>
  <head>
<style>
</style>
    <title>UMBC XChange</title>

	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

	<!-- Optional theme-->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

<!--Font Awesome -->

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" type="text/css" href="./css/main.css">


<link href="./css/pnotify.custom.min.css" media="all" rel="stylesheet" type="text/css" />

  <!-- Import jQuery -->
  <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>

	<!-- Latest compiled and minified JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>


  <script type="text/javascript" src="./js/pnotify.custom.min.js"></script>
  </head>
  <body>
<?php

 //Check for user's cookie. If cookie doesn't exist redirect to login page
 $userName = $_POST['cookie_name'];
 $cookie_name = $_POST['cookie_name'];
 $cookie_value = $_POST['cookie_value'];

 if(!isset($_COOKIE[$cookie_name]))
 {

   header("Location: index.html"); /* Redirect browser */
   exit();

 }
 else
 {
       if($_COOKIE[$cookie_name] != $cookie_value)
       {
         header("Location: index.html"); /* Redirect browser */
         exit();

       }
 }


  ?>
    <div class="titleBar">
        <img src="./images/logoko.png" style="height:100%; float:left; padding-left:30px"><br />
<!-- <<<<<<< HEAD -->
<!--         <p style="font-size:20px;margin-bottom:5px;">UMBC Xchange platform</p> -->
<!-- ======= -->
        <!--<p style="font-size:20px;margin-bottom:5px;">UMBC Xchange platform</p>-->
<!-- >>>>>>> b4437fcd53ff398bac0610b295ad72b0045acf5a
 -->
	<div class="row">
	 <div class="col-md-6 col-md-offset-2">
	    <div class="input-group">
	      <input type="text" class="form-control" placeholder="Search for...">
	      <span class="input-group-btn">
		<button class="btn btn-default" type="button">Go!</button>
	      </span>
	    </div><!-- /input-group -->
	  </div><!-- /.col-lg-6 -->
    <div class="col-md-4">
      <button type="button" id="logoutBtn" class="btn btn-default pull-right"><span class="glyphicon glyphicon-user"></span>  Logout</button>
    </div>
	</div> <!--row-->


</div> <!--titleBar-->

    <div class="sideMenu">
       <!-- <div class="sideBarButton"><a href="display_products.php" target="content_iframe">Home</a></div>-->
	<div class="sideBarButton"><a class="sideBarLink" id = "homePage" onclick="showPage(this.id)"><i class="fa fa-home" aria-hidden="true"></i> Home</a></div>
        <div class="sideBarButton"><a class="sideBarLink" id = "profilePage" onclick="showPage(this.id)"><i class="fa fa-user" aria-hidden="true"></i> Profile</a></div>
        <div class="sideBarButton"><a class="sideBarLink" id = "favoritesPage" onclick="showPage(this.id)"><i class="fa fa-star" aria-hidden="true"></i> My Favorites</a></div>
        <div class="sideBarButton"><a class="sideBarLink" id = "myItemsPage" onclick="showPage(this.id)"><i class="fa fa-list" aria-hidden="true"></i> My Items</a></div>
        <div class="sideBarButton"><a class="sideBarLink" id = "messagesPage" onclick="showPage(this.id)"><i class="fa fa-envelope" aria-hidden="true"></i> Messages</a></div>

    </div><!--sideMenu -->

 <!--   <div class="content" src="" id="content_frame" name="content_iframe"> -->
        <!--<iframe src="display_products.php" name="content_iframe"></iframe>-->
<div class="content" id="content_frame" name="content_iframe">

</div>

<?php include 'modals.html'; ?>

  </body>
   <script>

   var userName = <?php echo "'".$userName."'";?>;
   var sellerID;

   $( "#logoutBtn" ).click(function() {

     console.log("clicked");
      // $("#logOutModal").modal('show');
      console.log("user " + userName + " was logged out");
       $("#logOutModal").modal('show');


   });



$(document).ready(function() {
  // Hide the 'cover' div
    console.log("page was loaded");
});

   /*show additional info in Item Details Modal */
   $('.btn-mais-info').on('click', function(event) {
       $( '.open_info' ).toggleClass( "hide" );
   })


   $(".img").on("load",function(){
             console.log("all images were loaded");
       });

   $(function() {

     //Start loading items when first time redirected to main.html
             	$.get('./php/show_home.php', function(data) {
              		 $('#content_frame').html(data);
             	});



     // Handler for .ready() called.
   $("#content_frame").on("click", "#resetPswdBtn", function(){
       $("#password_modal").modal('show');
   });
   $("#content_frame").on("click", "#userImage", function(){
       $("#uploadUserPictureModal").modal('show');
   });


   });


        function showPage(id)
        {
        	alert(id);
        	var url = "";
        	if (id == "homePage"){url = './php/show_home.php';}
        	else if(id == "profilePage"){url = './php/show_profile.php';}
        	else if(id == "favoritesPage"){url = './php/show_favorites.php';}
        	else if(id == "uploadPage"){url = './php/show_upload.php';}
          else if(id == "favoritesPage"){url = './php/show_favorites.php';}
          else if(id == "myItemsPage"){url = './php/show_myItems.php';}
          else if(id == "messagesPage"){url = './php/show_messages.php';}

        	$.get(url, function(data) {
         		 $('#content_frame').html(data);
        	});



        }

        function showItemDetails(id)
        {
        	console.log("show item details"+ id);
        //	alert(id);
      //    var formData = new FormData();
      //    formData.append("item_id", id);
      //    var itemData = $(formData).serialize();
          // Get Item details with AJAX call
        //  var itemData =[];
        //  itemData['item_id'] = id;
          $.ajax({
              type: 'POST',
          //    dataType: 'json',
              url: './php/get_item_details.php',
          //    data: JSON.stringify({'item_id':id}),
                data: {'item_id':id},
          })
          .done(function(data) {
              // Make sure that the formMessages div has the 'success' class.
            //  console.log(data);
            //Parse JSON object
          var objData = jQuery.parseJSON(data);

          if(objData.result == 'success')
          {

                  var modalLabel = '<i class="text-muted fa fa-shopping-cart"></i> <strong>' + objData.item_name + '</strong>';
                  $("#myModalLabel").html(modalLabel);
                  var itemDetailsImage = '<img src="'+objData.image_link+'" alt="teste" class="img-thumbnail">';
                  $("#itemDetailsImage").html(itemDetailsImage);
                  $("#itemSoldBy").html(objData.seller);
                  $("#itemCondition").html(objData.condition);
                  $("#itemDescription").html(objData.description);
                  $("#itemManufacturer").html(objData.manufacturer);

                  $("#itemDetailsModal").modal('show');

          }
          else if(objData.result == 'error')
          {
            console.log("error occured when trying to retrieve information");
            //$('#userNotFound').show();
          }


          })
          .fail(function(data) {

              console.log("fail");
              // Set the message text.
          });



        }

        function addToFavorites(){
            PNotify.prototype.options.styling = "bootstrap3";
            PNotify.prototype.options.delay = 2000;

            var opts = [];
          //  opts.title = "Item was added to favorites!";
            opts.text = "Item was added to favorites!";
            opts.type = "info";
            new PNotify(opts);

        }
        function contactUser(){
            $('#itemDetailsModal').modal('hide');
              $('#sendMessageModal').modal('show');

        }




    </script>
<script src="js/main.js"></script>
</html>
